language: python
python:
  - 3.6
cache:
  directories:
    - $HOME/.cache/pip
    - $HOME/.ccache  # https://github.com/travis-ci/travis-ci/issues/5853


env:
  global:
    # Doctr deploy key for leilakhalili87/gbmc_v0
    - secure: "XhiI32ZjZdd8GSSuvaN8sidNDrzuURpATjQtc5a5NaZ7ZLOKuKBP6ggq/semerYj9eC2A4L43Q+eYZ5TyNxa/JFWlq+rqgfbY4meqHA6QD1d5W201WJE/oLS/FGcEXF+gW5RqXDsZc8/OtwRElP1WBAzHyGgp0VrJ1noQpe7oifD34CCAc2dcs7mLqpSUZAu1qjbZS66xsgj1yU7ZF4WDtYUb3ZMhz8MyVbEYSsqGQyEZwO/PUaqalQn0yMUnTG+7HTP7Tgc7pasDkaMdmn06QPrf64wO6QwrwtihYWDjhfMHtwNqRWhDe3MW3QHDn5txxuIj2DD2hAp6wVPcF7qpZaWlbqkPgaABAfPi2avWYmVuGx5WCN9/HK71nGY26JLNqWHPZOI1J/CfPB9LSL20jiGh+E7hPk4xvWdrCBOFtyTScSrmKD/bk8Z0XZxssW7Vat9rYR41J2io73o+Dc3acmkrvi62CBailGKMDE2jlsWudMtBgPJQPIoVB0aDH8NYXMUGktsEdFezH8nqx/Qq5PlUsf8rpsYQQF5uW56k8fK56EKRvMZEP5j/bYQfRX+Z8uEyIOC/vKExQBg65awAj4w0XLJ6ULJsxm3N4oofMzxfDf1Cc3FBpp25qh+IdN8ZUwVN1aDcwFVLFSnp4hjJYDrXzw6CyGDwxcr+rRaqBQ="
install:
  - sudo apt-get install -y
    pandoc
  # Install this package and the packages listed in requirements.txt.
  - pip install .
  # Install extra requirements for running tests and building docs.
  - pip install -r requirements-dev.txt

script:
  - coverage run -m pytest  # Run the tests and check for test coverage.
  - coverage report -m  # Generate test coverage report.
  - codecov  # Upload the report to codecov.
  - flake8  # Enforce code style ('relaxed' line length limit is set in .flake8 config file).
  - set -e
  - make -C docs html  # Build the documentation.
  - pip install doctr
  - doctr deploy --built-docs docs/build/html .
